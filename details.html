<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Produkt – Mays</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/style.css">
</head>
<body class="min-h-screen bg-pink-50 font-sans">

<!-- Top-Bar -->
<div class="bg-white border-b border-gray-100">
  <header class="max-w-6xl mx-auto px-4 py-3 grid grid-cols-[auto,1fr,auto] gap-3 items-center">
    <!-- Logo -->
    <a href="/index.html" class="flex items-center">
      <img src="/images/mays.png" alt="Mays Logo" class="h-20 w-auto object-contain">
    </a>

    <!-- Mittlerer Bereich: Button „Alle Produkte“ -->
    <div class="text-center">
      <a href="/index.html"
         class="inline-block px-4 py-2 rounded-xl bg-pink-100 text-pink-700 hover:bg-pink-200 font-semibold text-sm">
         Alle Produkte
      </a>
    </div>

    <!-- Warenkorb -->
    <a href="/cart.html" class="relative justify-self-end p-2 rounded-full hover:bg-pink-50 border border-pink-200">
      <svg class="h-6 w-6 text-gray-800" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 3h2l2.2 10.5a2 2 0 0 0 2 1.5h8.6a2 2 0 0 0 2-1.6l1.1-6.4H6.1"/>
        <circle cx="9" cy="20" r="1.6"/>
        <circle cx="18" cy="20" r="1.6"/>
      </svg>
      <span id="cartBadge" class="absolute -top-1 -right-1 text-[11px] bg-pink-500 text-white rounded-full px-1.5 py-0.5">0</span>
    </a>
  </header>
</div>

<!-- Inhalt -->
<main class="max-w-6xl mx-auto px-4 py-8" id="detailsRoot">
  <!-- Wird per JS befüllt -->
</main>

<!-- Script einbinden -->
<script src="/script.js"></script>

<!-- Produkt anzeigen, wenn Daten geladen sind -->
<script>
  window.MAYS_PRODUCTS_READY.then(() => {
    const urlParams = new URLSearchParams(window.location.search);
    const productId = urlParams.get("id");
    const product = (window.MAYS_PRODUCTS || []).find(p => p.id === productId);

    if (!product) {
      document.getElementById("detailsRoot").innerHTML = "<p>Produkt nicht gefunden.</p>";
      return;
    }

    const root = document.getElementById("detailsRoot");
    root.innerHTML = `
      <div class="bg-white rounded-2xl shadow p-6 grid gap-4 md:grid-cols-2">
        <img src="${product.images?.[0] || "/images/mays.png"}" class="w-full rounded-xl object-cover" alt="${product.name}">
        <div>
          <h1 class="text-2xl font-bold">${product.name}</h1>
          <p class="text-gray-700 mt-2">${product.description || ""}</p>

          ${product.variants ? `
            <label for="variantSelect" class="block text-sm font-medium text-gray-700 mt-4">Packungsgröße</label>
            <select id="variantSelect" class="mt-1 block w-full border border-pink-200 rounded-lg p-2">
              ${product.variants.map(v => `<option value="${v.id}">${v.label} – € ${(v.price / 100).toFixed(2).replace(".", ",")}</option>`).join("")}
            </select>
          ` : `
            <div class="text-pink-700 font-bold mt-4 text-lg">
              € ${(product.price / 100).toFixed(2).replace(".", ",")}
            </div>
          `}

          <button id="addToCartBtn"
            class="mt-4 w-full bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-4 rounded-xl">
            In den Warenkorb
          </button>
        </div>
      </div>
    `;

    // Event-Handler für Warenkorb-Button
    document.getElementById("addToCartBtn").addEventListener("click", () => {
      let variant = null;
      if (product.variants && product.variants.length > 0) {
        const selectedId = document.getElementById("variantSelect").value;
        variant = product.variants.find(v => v.id === selectedId);
      }

      addToCart(product.id, 1, variant);
      alert("Zum Warenkorb hinzugefügt!");
    });
  });
</script>

</body>
</html>
